/* ==========================================
   Print Styles
   Optimized for printing articles - Modern, Aesthetic & Themed
   ========================================== */

@media print {

    /* ==========================================
       Reset & Page Setup
       ========================================== */
    @page {
        margin: 2cm;
        size: auto;
    }

    /* Selective Reset - Relaxed to allow colors */
    *,
    *::before,
    *::after {
        background: transparent;
        /* Allow background overrides */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    /* Hide UI elements non-essential for print */
    .main-header,
    .main-footer,
    .back-btn,
    .theme-toggle,
    .scroll-to-top,
    .connection-status,
    .article-actions,
    .article-detail-footer,
    .article-toc,
    .btn-edit,
    .btn-print,
    .filters-section,
    .import-section,
    #toast,
    .copy-btn,
    .nav-btn,
    .article-detail-favorite,
    aside {
        display: none !important;
    }

    /* ==========================================
       Typography
       ========================================== */
    body {
        margin: 0;
        padding: 0;
        font-family: 'Heebo', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        font-size: 11pt;
        line-height: 1.5;
        color: #1a1a1a;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }

    /* ==========================================
       Layout Containers
       ========================================== */
    .main-content,
    .article-detail-wrapper,
    .article-detail-container {
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        border: none !important;
        box-shadow: none !important;
        display: block !important;
        max-width: none !important;
    }

    /* ==========================================
       Header Styling (Themed)
       ========================================== */
    .article-detail-header {
        border-bottom: 2px solid var(--primary);
        /* Theme Red */
        padding-bottom: 1.5rem !important;
        margin-bottom: 2rem !important;
    }

    .article-detail-header h1 {
        font-size: 24pt !important;
        font-weight: 700 !important;
        margin-bottom: 0.5rem !important;
        line-height: 1.2 !important;
        color: var(--primary-dark) !important;
        /* Theme Dark Red */
    }

    .article-detail-meta {
        font-size: 9pt !important;
        color: #555 !important;
        margin-top: 0.5rem !important;
        display: flex !important;
        gap: 1.5rem !important;
    }

    .article-detail-meta span {
        border: 1px solid var(--primary-light);
        /* Darker Theme Border for visibility */
        background-color: #fff !important;
        /* White bg for contrast */
        padding: 2px 8px;
        border-radius: 4px;
        color: var(--primary-dark) !important;
        /* Dark red text */
        font-weight: 600;
    }

    /* ==========================================
       Content Typography (Themed)
       ========================================== */
    .article-detail-body {
        font-size: 11pt !important;
        line-height: 1.6 !important;
    }

    .article-detail-body h1,
    .article-detail-body h2,
    .article-detail-body h3,
    .article-detail-body h4 {
        color: var(--primary-dark) !important;
        /* Theme Dark Red */
    }

    .article-detail-body h1 {
        font-size: 18pt !important;
        margin-top: 2rem !important;
        padding-bottom: 0.3rem;
        border-bottom: 1px solid var(--primary-lightest);
    }

    .article-detail-body h2 {
        font-size: 16pt !important;
        margin-top: 1.8rem !important;
        padding-bottom: 0.2rem;
        border-bottom: 1px solid var(--primary-lightest);
    }

    .article-detail-body h3 {
        font-size: 14pt !important;
        margin-top: 1.5rem !important;
    }

    .article-detail-body h4 {
        font-size: 12pt !important;
        margin-top: 1.2rem !important;
    }

    /* Paragraphs & Spacing */
    .article-detail-body p {
        orphans: 3;
        widows: 3;
        margin-bottom: 1rem !important;
        text-align: justify;
    }

    /* ==========================================
       Components
       ========================================== */

    /* Blockquotes */
    .article-detail-body blockquote {
        border-right: 4px solid var(--primary) !important;
        /* Theme Accent */
        margin: 1.5rem 0 !important;
        padding: 0.5rem 1rem !important;
        background-color: var(--primary-lightest) !important;
        /* Very light red bg */
        color: var(--primary-dark);
        font-style: italic !important;
        page-break-inside: avoid;
    }

    /* Code Blocks */
    .article-detail-body pre {
        background: #f8f9fa !important;
        border: 1px solid #e9ecef !important;
        border-left: 3px solid var(--primary-light) !important;
        /* Theme accent on code */
        border-radius: 6px !important;
        padding: 1rem !important;
        margin: 1.5rem 0 !important;
        white-space: pre-wrap !important;
        word-break: break-all;
        page-break-inside: avoid;
    }

    .article-detail-body code {
        font-family: 'Consolas', 'Monaco', 'Courier New', monospace !important;
        font-size: 9pt !important;
        background-color: #fff !important;
        padding: 2px 4px !important;
        border-radius: 3px !important;
        color: var(--primary-dark) !important;
        /* Code text color */
    }

    .article-detail-body pre code {
        background-color: transparent !important;
        padding: 0 !important;
        border: none !important;
        color: #333 !important;
        /* Revert to standard color for code blocks */
    }

    /* Tables */
    .article-detail-body table {
        width: 100% !important;
        border-collapse: collapse !important;
        margin: 1.5rem 0 !important;
        page-break-inside: avoid;
        font-size: 10pt !important;
    }

    .article-detail-body th,
    .article-detail-body td {
        border: 1px solid #ddd !important;
        padding: 8px 12px !important;
        text-align: right !important;
        /* RTL support */
    }

    .article-detail-body th {
        background-color: var(--primary-lightest) !important;
        /* Theme table header */
        color: var(--primary-dark) !important;
        font-weight: 600 !important;
    }

    /* Images */
    .article-detail-body img {
        max-width: 100% !important;
        height: auto !important;
        page-break-inside: avoid;
        border-radius: 4px !important;
        margin: 1rem 0 !important;
        border: 1px solid #eee;
    }

    /* Links */
    a {
        text-decoration: none !important;
        color: var(--primary) !important;
        /* Theme Link Color */
    }

    /* Intelligent Link Display */
    .article-detail-body a[href^="http"]:not([href*="localhost"])::after {
        content: " (" attr(href) ")";
        font-size: 0.8em;
        color: var(--dark-gray);
        word-break: break-all;
    }

    a[href^="#"]::after,
    a[href^="javascript"]::after,
    a img::after {
        content: "" !important;
    }

    /* Lists */
    .article-detail-body ul,
    .article-detail-body ol {
        margin: 1rem 0 !important;
        padding-right: 1.5rem !important;
    }

    .article-detail-body li {
        margin-bottom: 0.5rem !important;
    }

    .article-detail-body li::marker {
        color: var(--primary);
        /* Theme colored bullets */
    }

    /* ==========================================
       Attachments Section
       ========================================== */
    .article-attachments {
        margin-top: 3rem !important;
        border-top: 2px solid var(--primary-lightest) !important;
        padding-top: 1rem !important;
        page-break-before: avoid;
    }

    .article-attachments h3 {
        font-size: 14pt !important;
        margin-bottom: 1rem !important;
        color: var(--primary-dark) !important;
    }

    .download-list {
        display: block !important;
    }

    .download-item {
        display: flex !important;
        align-items: center !important;
        padding: 0.5rem !important;
        border-bottom: 1px solid #eee !important;
        background: none !important;
    }

    .download-item .file-name {
        font-weight: 500 !important;
        color: var(--primary) !important;
    }

    /* ==========================================
       Print Metadata Footer
       ========================================== */
    .print-metadata {
        display: block !important;
        margin-top: 3rem !important;
        padding-top: 2rem !important;
        border-top: 2px solid var(--primary-lightest) !important;
        page-break-before: avoid;
    }

    .print-metadata h4 {
        font-size: 12pt !important;
        color: var(--primary-dark) !important;
        margin-bottom: 1rem !important;
    }

    .print-metadata p {
        font-size: 9pt !important;
        margin-bottom: 0.5rem !important;
        color: #555 !important;
    }

    .print-metadata strong {
        color: var(--primary-dark) !important;
    }

    /* Page Numbers and Footer */
    @page {
        margin: 2.5cm 2cm 3cm 2cm;

        @bottom-center {
            content: "עמוד " counter(page) " מתוך " counter(pages);
            font-size: 9pt;
            color: #666;
        }

        @bottom-right {
            content: "Knowledge Repository";
            font-size: 8pt;
            color: #999;
        }

        @bottom-left {
            content: "Knowledge Repository";
            font-size: 8pt;
            color: #999;
        }
    }

    /* Page Break Control */
    .article-detail-header,
    .article-detail-body h1,
    .article-detail-body h2 {
        page-break-after: avoid;
    }

    .article-detail-body h1,
    .article-detail-body h2,
    .article-detail-body h3 {
        page-break-after: avoid;
        page-break-inside: avoid;
    }

    .article-detail-body p,
    .article-detail-body li {
        page-break-inside: avoid;
    }

    .article-detail-body table,
    .article-detail-body pre,
    .article-detail-body blockquote,
    .article-detail-body img {
        page-break-inside: avoid;
    }

    /* Better Code Block Printing */
    .article-detail-body pre {
        white-space: pre-wrap !important;
        word-wrap: break-word !important;
        max-width: 100% !important;
        overflow: visible !important;
    }

    .article-detail-body code {
        word-break: break-all !important;
        white-space: pre-wrap !important;
    }

    /* Summary Box for Print */
    .article-summary-print {
        display: block !important;
        background: var(--primary-lightest) !important;
        border-right: 4px solid var(--primary) !important;
        padding: 1rem !important;
        margin: 1.5rem 0 !important;
        border-radius: 6px !important;
        page-break-inside: avoid;
    }

    .article-summary-print strong {
        color: var(--primary-dark) !important;
        font-weight: 600 !important;
    }
}